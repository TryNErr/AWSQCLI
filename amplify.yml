version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd testace-app/frontend
        - echo "=== Installing Yarn for better dependency resolution ==="
        - npm install -g yarn
        - echo "=== Cleaning up npm artifacts ==="
        - rm -rf node_modules package-lock.json yarn.lock
        - echo "=== Installing dependencies with Yarn ==="
        - yarn install --ignore-engines --network-timeout 300000
        - echo "=== Dependencies installed successfully with Yarn ==="
    build:
      commands:
        - echo "=== Building with Yarn ==="
        - yarn build
        - echo "=== Build completed successfully ==="
  artifacts:
    baseDirectory: testace-app/frontend/build
    files:
      - '**/*'
  cache:
    paths:
      - testace-app/frontend/node_modules/**/*
  customHeaders:
    - pattern: '**/*'
      headers:
        - key: 'X-Frame-Options'
          value: 'DENY'
        - key: 'X-XSS-Protection'
          value: '1; mode=block'
        - key: 'X-Content-Type-Options'
          value: 'nosniff'
